void TIM3Init (void)
{
//Включение альтернативной функции таймера 3 для ножки PC9
AFIO->MAPR |= AFIO_MAPR_TIM3_REMAP;

//Включение таймера 2 на шине APB1
RCC->APB1ENR |= RCC_APB1ENR_TIM3EN;

TIM3->PSC = 24;//На сколько делиться частота контроллера
						//24 000 000 /24= 1 000 000

TIM3->ARR=10; //до скольки таймер считает перед сбросом
			 // 10/1 000 000 = 100кГц
/*чтобы перевести в секунды, надо 1/100кГц=0.00001 с (период)
и умножить на отношение CCR4/ARR=0.1 (0.1)*0.00001 сек горит светодиод */

TIM3->CCR4 = 5; //(коэф запол-я ШИМ) до скольки таймер считает перед сбросом
						//Коэф запол-я: (К) = ССCR4/ARR *100% = 5/10*100=50%

//TIM3->CCER |=TIM_CCER_CC4E;//разблокируем модуль сравнения данных таймера 3

TIM3->CCMR2 |= TIM_CCMR2_OC4M_1 | TIM_CCMR2_OC4M_2;//режим ШИМ1 таймера 3

TIM3->CR1 |= TIM_CR1_CEN; //вкдючение таймера 3
}
